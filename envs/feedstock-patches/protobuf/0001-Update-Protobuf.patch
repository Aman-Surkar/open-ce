From 724bae3db1ce1953644d0cf5d87608f92c58857d Mon Sep 17 00:00:00 2001
From: Aman Surkar <Aman.Surkar@ibm.com>
Date: Mon, 13 May 2024 05:29:49 +0000
Subject: [PATCH] Update Protobuf

---
 recipe/meta.yaml | 14 +++++++-------
 1 file changed, 7 insertions(+), 7 deletions(-)

diff --git a/recipe/meta.yaml b/recipe/meta.yaml
index 773a344..0eb1105 100644
--- a/recipe/meta.yaml
+++ b/recipe/meta.yaml
@@ -1,5 +1,5 @@
 # keep this without major version to let the bot pick it up
-{% set version = "25.3" %}
+{% set version = "26.1" %}
 # protobuf doesn't add the major version in the tag, it's defined per language in
 # https://github.com/protocolbuffers/protobuf/blob/main/version.json
 {% set major = "4" %}
@@ -12,7 +12,7 @@ package:
 
 source:
   url: https://github.com/protocolbuffers/protobuf/archive/refs/tags/v{{ version }}.tar.gz
-  sha256: d19643d265b978383352b3143f04c0641eea75a75235c111cc01a1350173180e
+  sha256: 4fc5ff1b2c339fb86cd3a25f0b5311478ab081e65ad258c6789359cd84d421f8
   patches:
     - patches/0001-do-not-link-msvc-runtime-statically.patch
     - patches/0002-fix-paths-for-include-lib-directories.patch
@@ -21,25 +21,25 @@ source:
     - patches/0005-set-PROTOBUF_USE_DLLS-on-windows.patch
 
 build:
-  number: 0
+  number: 1
   script:
     - cd python
     - export PROTOC=$PREFIX/bin/protoc        # [unix and (build_platform == target_platform)]
     - export PROTOC=$BUILD_PREFIX/bin/protoc  # [unix and (build_platform != target_platform)]
     - set PROTOC=%LIBRARY_BIN%\protoc         # [win]
     - python setup.py bdist_wheel --cpp_implementation
-    - {{ PYTHON }} -m pip install -f dist protobuf=={{ major ~ "." ~ version }}
+    - {{ PYTHON }} -m pip install --use-pep517 . -vv --config-setting="--build-option=--cpp_implementation" 
 
 requirements:
   build:
     - python                                 # [build_platform != target_platform]
     - cross-python_{{ target_platform }}     # [build_platform != target_platform]
     - libprotobuf {{ lib_major ~ "." ~ version }}  # [build_platform != target_platform]
-    - {{ compiler('c') }}
-    - {{ compiler('cxx') }}
+    - {{ compiler('c') }}    #[ppc_arch != "p10"]
+    - {{ compiler('cxx') }}  #[ppc_arch != "p10"]
   host:
     - python
-    - pip
+    - pip 23.*
     - setuptools
     - libabseil
     - libprotobuf {{ lib_major ~ "." ~ version }}
-- 
2.40.1

